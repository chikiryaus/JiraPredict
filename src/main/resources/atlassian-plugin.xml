<?xml version="1.0" encoding="UTF-8"?>

<atlassian-plugin key="${atlassian.plugin.key}" name="${project.name}" plugins-version="2"> 
  <plugin-info> 
    <description>${project.description}</description>  
    <version>${project.version}</version>  
    <vendor name="${project.organization.name}" url="${project.organization.url}"/>  
    <param name="plugin-icon">images/pluginIcon.png</param>  
    <param name="plugin-logo">images/pluginLogo.png</param> 
  </plugin-info>  
  <!-- add our i18n resource -->  
  <resource type="i18n" name="i18n" location="myPlugin"/>  
  <!-- add our web resources -->  
  <web-resource key="myPlugin-resources" name="myPlugin Web Resources"> 
    <dependency>com.atlassian.auiplugin:ajs</dependency>  
    <resource type="download" name="myPlugin.css" location="/css/myPlugin.css"/>  
    <resource type="download" name="myPlugin.js" location="/js/myPlugin.js"/>  
    <resource type="download" name="images/" location="/images"/>  
    <context>myPlugin</context> 
  </web-resource>  
  <web-section name="mySection" i18n-name-key="my-section.name" key="my-section" location="my-item-link" weight="1000"> 
    <description key="my-section.description">The mySection Plugin</description> 
  </web-section>  
  <web-item name="myItem" i18n-name-key="my-item.name" key="my-item" section="system.top.navigation.bar" weight="1000"> 
    <description key="my-item.description">The myItem Plugin</description>  
    <label key="my-item.label"/>  
    <link linkId="my-item-link"/> 
  </web-item>
  <!-- Панель для отображения информации о задаче -->
  <web-panel name="Issue Info Panel" i18n-name-key="issue-info-panel.name" key="issue-info-panel" location="atl.jira.view.issue.right.context" weight="1000"> 
    <description key="issue-info-panel.description">The Issue Info Panel Plugin</description>
    <!-- Шаблон для отображения -->
    <resource name="view" type="velocity" location="/templates/issue-info-panel.vm"/>
    <!-- Класс, который подготовит данные -->
    <context-provider class="com.atlassian.tutorial.myPlugin.ui.IssueInfoContextProvider"/>
  </web-panel>

  <!-- Сервлет для конфигурации -->
  <servlet name="Gemini Config Servlet" i18n-name-key="gemini-config-servlet.name" key="gemini-config-servlet" class="com.atlassian.tutorial.myPlugin.servlet.GeminiConfigServlet">
    <description key="gemini-config-servlet.description">Конфигурация API ключа для Gemini.</description>
    <url-pattern>/gemini-config</url-pattern> <!-- URL будет /jira/plugins/servlet/gemini-config -->
  </servlet>

  <!-- Добавляем ссылку на страницу конфигурации в секцию "Управление приложениями" -->
  <!-- Создаем свою подсекцию для нашего плагина (опционально, но улучшает организацию) -->
  <web-section name="My Plugin Admin Section"
               key="myplugin-admin-section" location="admin_plugins_menu" weight="300">
    <label key="myplugin.admin.section.label">JiraPredict Settings</label> <!-- Название вашей секции -->
  </web-section>

  <web-item name="Gemini API Key Config"
            key="gemini-api-key-config" section="admin_plugins_menu/myplugin-admin-section" weight="10">
    <label key="gemini-api-key-config.label">Configuration Gemini API</label>
    <link linkId="gemini-api-k
    ey-config-link">/plugins/servlet/gemini-config</link>
  </web-item>

  <!-- Сервлет для страницы аналитики -->
  <servlet name="Analytics Servlet" i18n-name-key="analytics-servlet.name" key="analytics-servlet" class="com.atlassian.tutorial.myPlugin.servlet.AnalyticsServlet">
    <url-pattern>/prediction-analytics</url-pattern>
  </servlet>

  <!-- Ссылка в меню настроек -->
  <web-item name="Prediction Analytics" key="prediction-analytics" section="admin_plugins_menu/myplugin-admin-section" weight="20">
    <label>Аналитика прогнозов</label>
    <link linkId="prediction-analytics-link">/plugins/servlet/prediction-analytics</link>
  </web-item>

</atlassian-plugin>
